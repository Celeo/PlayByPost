{% extends 'base.jinja2' %}

{% block body %}

<div class="container">
  <h1>Campaigns</h1>
  <br>

  <table class="table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Last post</th>
        <th>Your character</th>
      </tr>
    </thead>
    <tbody>
      {% for campaign in campaigns %}
        <tr>
          <td><a href="{{ url_for('base.campaign_posts', campaign_id=campaign.id) }}" class="btn btn-outline-primary">{{ campaign.name }}</a></td>
          <td>
            {% if campaign.posts %}
              {{ campaign.posts[-1].date | format_date }}
            {% else %}
              Never
            {% endif %}
          </td>
          <td>
            {% with campaign_char = current_user.get_character_in_campaign(campaign) %}
              {% if campaign_char %}
                {{ campaign_char.name }}
              {% endif %}
            {% endwith %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <br>
  <hr style="margin-top: 3rem;">
  <h3>Create a new campaign</h3>
  <form action="{{ url_for('base.campaigns') }}" method="POST">
    <div class="form-group">
      <label for="name">Name</label>
      <input type="text" class="form-control" name="name" placeholder="Name of campaign" required>
    </div>
    <div class="form-group">
      <label for="description">Description</label>
      <textarea class="form-control" name="description"></textarea>
    </div>
    <button type="submit" class="btn btn-primary">Create new</button>
  </form>
</div>

{% endblock %}
